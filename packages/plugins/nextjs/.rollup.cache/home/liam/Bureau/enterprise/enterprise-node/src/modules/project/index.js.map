{"version":3,"file":"index.js","sourceRoot":"","sources":["index.ts"],"names":[],"mappings":"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","sourcesContent":["import { ModuleInterface } from '../../types';\nimport { WasmRuntime } from '../../core/runtime';\n\nexport interface ProjectData {\n  id: string;\n  name: string;\n  description?: string;\n  createdAt: number;\n  updatedAt: number;\n  metadata?: any;\n  settings?: any;\n}\n\nexport class Project implements ModuleInterface {\n  name = 'project';\n  version = '0.1.0';\n  private runtime: WasmRuntime;\n  private currentProject: ProjectData | null = null;\n  private projects: Map<string, ProjectData> = new Map();\n\n  constructor(runtime: WasmRuntime) {\n    this.runtime = runtime;\n  }\n\n  async init(): Promise<void> {\n    console.log('Project Module initialized');\n    await this.loadProjects();\n  }\n\n  async destroy(): Promise<void> {\n    await this.saveProjects();\n    this.currentProject = null;\n    this.projects.clear();\n    console.log('Project Module destroyed');\n  }\n\n  async create(name: string, options?: {\n    description?: string;\n    template?: string;\n    settings?: any;\n  }): Promise<ProjectData> {\n    try {\n      const project: ProjectData = {\n        id: `project_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        name,\n        description: options?.description,\n        createdAt: Date.now(),\n        updatedAt: Date.now(),\n        metadata: {\n          template: options?.template || 'default',\n          version: '0.1.0'\n        },\n        settings: options?.settings || {}\n      };\n\n      const result = await this.runtime.call('project_create', project);\n      this.projects.set(project.id, project);\n\n      return {\n        ...project,\n        ...result\n      };\n    } catch (error) {\n      console.error('Project create failed:', error);\n      throw new Error(`Failed to create project: ${name}`);\n    }\n  }\n\n  async open(projectIdOrName: string): Promise<{\n    project: ProjectData;\n    opened: boolean;\n  }> {\n    try {\n      let project: ProjectData | undefined;\n\n      project = this.projects.get(projectIdOrName);\n      \n      if (!project) {\n        for (const p of this.projects.values()) {\n          if (p.name === projectIdOrName) {\n            project = p;\n            break;\n          }\n        }\n      }\n\n      if (!project) {\n        throw new Error(`Project not found: ${projectIdOrName}`);\n      }\n\n      const result = await this.runtime.call('project_open', project.id);\n      this.currentProject = project;\n\n      return {\n        project,\n        opened: result.opened !== false\n      };\n    } catch (error) {\n      console.error('Project open failed:', error);\n      throw new Error(`Failed to open project: ${projectIdOrName}`);\n    }\n  }\n\n  async save(projectId?: string): Promise<{\n    saved: boolean;\n    project?: ProjectData;\n  }> {\n    try {\n      const project = projectId ? \n        this.projects.get(projectId) : \n        this.currentProject;\n\n      if (!project) {\n        throw new Error('No project to save');\n      }\n\n      project.updatedAt = Date.now();\n      \n      const result = await this.runtime.call('project_save', project);\n      this.projects.set(project.id, project);\n\n      return {\n        saved: result.saved !== false,\n        project\n      };\n    } catch (error) {\n      console.error('Project save failed:', error);\n      throw new Error('Failed to save project');\n    }\n  }\n\n  async delete(projectId: string): Promise<{\n    deleted: boolean;\n  }> {\n    try {\n      const project = this.projects.get(projectId);\n      if (!project) {\n        throw new Error(`Project not found: ${projectId}`);\n      }\n\n      const result = await this.runtime.call('project_delete', projectId);\n      this.projects.delete(projectId);\n\n      if (this.currentProject?.id === projectId) {\n        this.currentProject = null;\n      }\n\n      return { deleted: result.deleted !== false };\n    } catch (error) {\n      console.error('Project delete failed:', error);\n      throw new Error(`Failed to delete project: ${projectId}`);\n    }\n  }\n\n  async list(): Promise<{\n    projects: ProjectData[];\n  }> {\n    return {\n      projects: Array.from(this.projects.values()).sort((a, b) => b.updatedAt - a.updatedAt)\n    };\n  }\n\n  getCurrentProject(): ProjectData | null {\n    return this.currentProject;\n  }\n\n  async updateSettings(projectId: string, settings: any): Promise<{\n    updated: boolean;\n    project?: ProjectData;\n  }> {\n    const project = this.projects.get(projectId);\n    if (!project) {\n      throw new Error(`Project not found: ${projectId}`);\n    }\n\n    project.settings = { ...project.settings, ...settings };\n    project.updatedAt = Date.now();\n\n    this.projects.set(projectId, project);\n\n    return {\n      updated: true,\n      project\n    };\n  }\n\n  private async loadProjects(): Promise<void> {\n    try {\n      const stored = localStorage.getItem('enterprise_projects');\n      if (stored) {\n        const projectsData = JSON.parse(stored);\n        projectsData.forEach((p: ProjectData) => {\n          this.projects.set(p.id, p);\n        });\n      }\n    } catch (error) {\n      console.warn('Failed to load projects from storage:', error);\n    }\n  }\n\n  private async saveProjects(): Promise<void> {\n    try {\n      const projectsData = Array.from(this.projects.values());\n      localStorage.setItem('enterprise_projects', JSON.stringify(projectsData));\n    } catch (error) {\n      console.warn('Failed to save projects to storage:', error);\n    }\n  }\n}\n\nexport default Project;"]}