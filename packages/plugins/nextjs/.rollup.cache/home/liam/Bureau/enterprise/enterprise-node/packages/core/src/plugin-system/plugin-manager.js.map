{"version":3,"file":"plugin-manager.js","sourceRoot":"","sources":["plugin-manager.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @fileoverview Plugin Manager\n * Gestionnaire central du syst√®me de plugins Enterprise\n */\n\nimport {\n  EnterprisePlugin,\n  PluginManifest,\n  PluginContext,\n  PluginLoadResult,\n  PluginSystemConfig,\n  PluginEvent,\n  PluginLogger,\n  PluginUtils,\n} from './types';\nimport { EventEmitter } from 'events';\n\nexport class PluginManager extends EventEmitter {\n  private static instance: PluginManager;\n  private plugins: Map<string, EnterprisePlugin> = new Map();\n  private manifests: Map<string, PluginManifest> = new Map();\n  private config: PluginSystemConfig;\n  private context?: PluginContext;\n\n  private constructor(config: PluginSystemConfig = {}) {\n    super();\n    this.config = {\n      pluginDirs: ['node_modules/@skygenesisenterprise/plugins', 'plugins'],\n      autoLoad: [],\n      exclude: [],\n      devMode: false,\n      verbose: false,\n      enableCache: true,\n      cacheDir: '.enterprise/plugins',\n      allowUnsafePlugins: false,\n      trustedAuthors: ['skygenesisenterprise'],\n      ...config,\n    };\n  }\n\n  static getInstance(config?: PluginSystemConfig): PluginManager {\n    if (!PluginManager.instance) {\n      PluginManager.instance = new PluginManager(config);\n    }\n    return PluginManager.instance;\n  }\n\n  /**\n   * Initialise le gestionnaire de plugins avec un contexte\n   */\n  async initialize(context: PluginContext): Promise<void> {\n    this.context = context;\n\n    if (this.config.verbose) {\n      context.logger.info('üîå Initialisation du syst√®me de plugins...');\n    }\n\n    // Charger les plugins automatiquement\n    await this.loadAutoPlugins();\n\n    // Charger les plugins depuis la configuration\n    await this.loadConfigPlugins(context.config);\n\n    if (this.config.verbose) {\n      context.logger.info(`‚úÖ ${this.plugins.size} plugin(s) charg√©(s)`);\n    }\n  }\n\n  /**\n   * Charge un plugin depuis son nom ou chemin\n   */\n  async loadPlugin(identifier: string): Promise<PluginLoadResult> {\n    try {\n      const manifest = await this.loadPluginManifest(identifier);\n\n      // Validation du plugin\n      const validation = this.validatePlugin(manifest);\n      if (!validation.valid) {\n        return {\n          plugin: null as any,\n          success: false,\n          error: new Error(`Plugin invalide: ${validation.errors.join(', ')}`),\n        };\n      }\n\n      // Chargement du module du plugin\n      const PluginClass = await this.loadPluginModule(manifest);\n      const plugin = new PluginClass();\n\n      // V√©rification de l'interface\n      if (!this.isValidPlugin(plugin)) {\n        return {\n          plugin: null as any,\n          success: false,\n          error: new Error(\"Le plugin n'impl√©mente pas l'interface EnterprisePlugin\"),\n        };\n      }\n\n      // Initialisation du plugin\n      if (this.context) {\n        await plugin.initialize(this.context);\n      }\n\n      // Enregistrement du plugin\n      this.plugins.set(manifest.name, plugin);\n      this.manifests.set(manifest.name, manifest);\n\n      // √âmission de l'√©v√©nement\n      this.emit('plugin:loaded', { name: manifest.name, plugin });\n\n      if (this.config.verbose) {\n        this.context?.logger.info(`üîå Plugin charg√©: ${manifest.name}@${manifest.version}`);\n      }\n\n      return {\n        plugin,\n        success: true,\n      };\n    } catch (error) {\n      return {\n        plugin: null as any,\n        success: false,\n        error: error instanceof Error ? error : new Error(String(error)),\n      };\n    }\n  }\n\n  /**\n   * D√©charge un plugin\n   */\n  async unloadPlugin(name: string): Promise<void> {\n    const plugin = this.plugins.get(name);\n    if (!plugin) {\n      throw new Error(`Plugin non trouv√©: ${name}`);\n    }\n\n    try {\n      await plugin.destroy();\n      this.plugins.delete(name);\n      this.manifests.delete(name);\n\n      this.emit('plugin:unloaded', { name });\n\n      if (this.config.verbose) {\n        this.context?.logger.info(`üîå Plugin d√©charg√©: ${name}`);\n      }\n    } catch (error) {\n      this.context?.logger.error(`Erreur lors du d√©chargement du plugin ${name}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Retourne un plugin par son nom\n   */\n  getPlugin(name: string): EnterprisePlugin | undefined {\n    return this.plugins.get(name);\n  }\n\n  /**\n   * Retourne tous les plugins charg√©s\n   */\n  getPlugins(): Map<string, EnterprisePlugin> {\n    return new Map(this.plugins);\n  }\n\n  /**\n   * Retourne les plugins par cat√©gorie\n   */\n  getPluginsByCategory(category: string): EnterprisePlugin[] {\n    return Array.from(this.plugins.values()).filter(\n      (plugin) => plugin.manifest.category === category\n    );\n  }\n\n  /**\n   * Retourne les plugins qui supportent un framework sp√©cifique\n   */\n  getPluginsForFramework(framework: string): EnterprisePlugin[] {\n    return Array.from(this.plugins.values()).filter((plugin) =>\n      plugin.manifest.supports.includes(framework)\n    );\n  }\n\n  /**\n   * Ex√©cute un hook sur tous les plugins\n   */\n  async executeHook(hookName: string, data?: any): Promise<void> {\n    const promises = Array.from(this.plugins.values()).map(async (plugin) => {\n      const hook = plugin[hookName as keyof EnterprisePlugin];\n      if (typeof hook === 'function' && this.context) {\n        try {\n          await (hook as Function).call(plugin, this.context, data);\n        } catch (error) {\n          this.context?.logger.error(\n            `Erreur dans le hook ${hookName} du plugin ${plugin.manifest.name}:`,\n            error\n          );\n        }\n      }\n    });\n\n    await Promise.all(promises);\n  }\n\n  /**\n   * Retourne les commandes de tous les plugins\n   */\n  getPluginCommands(): any[] {\n    const commands: any[] = [];\n\n    for (const plugin of this.plugins.values()) {\n      if (plugin.getCommands) {\n        const pluginCommands = plugin.getCommands();\n        commands.push(\n          ...pluginCommands.map((cmd) => ({\n            ...cmd,\n            plugin: plugin.manifest.name,\n            category: cmd.category || 'plugin',\n          }))\n        );\n      }\n    }\n\n    return commands;\n  }\n\n  /**\n   * Charge le manifest d'un plugin\n   */\n  private async loadPluginManifest(identifier: string): Promise<PluginManifest> {\n    // Essayer de charger depuis node_modules\n    try {\n      const packagePath = require.resolve(`${identifier}/package.json`);\n      const packageJson = require(packagePath);\n\n      if (packageJson.enterprise?.plugin) {\n        return packageJson.enterprise.plugin;\n      }\n    } catch {\n      // Continuer avec d'autres m√©thodes\n    }\n\n    // Essayer de charger depuis un chemin local\n    try {\n      const manifestPath = require.resolve(`${identifier}/plugin.json`);\n      const manifest = require(manifestPath);\n      return manifest;\n    } catch {\n      // Continuer avec d'autres m√©thodes\n    }\n\n    throw new Error(`Impossible de trouver le manifest pour le plugin: ${identifier}`);\n  }\n\n  /**\n   * Charge le module d'un plugin\n   */\n  private async loadPluginModule(manifest: PluginManifest): Promise<any> {\n    const modulePath = require.resolve(manifest.main);\n    const module = await import(modulePath);\n\n    return module.default || module;\n  }\n\n  /**\n   * Valide un manifest de plugin\n   */\n  private validatePlugin(manifest: PluginManifest): { valid: boolean; errors: string[] } {\n    const errors: string[] = [];\n\n    if (!manifest.name) errors.push('Le nom est requis');\n    if (!manifest.version) errors.push('La version est requise');\n    if (!manifest.main) errors.push(\"Le point d'entr√©e est requis\");\n    if (!manifest.category) errors.push('La cat√©gorie est requise');\n    if (!manifest.supports || manifest.supports.length === 0) {\n      errors.push('Au moins un framework support√© est requis');\n    }\n\n    // Validation de s√©curit√©\n    if (!this.config.allowUnsafePlugins && !manifest.enterprise?.certified) {\n      errors.push('Plugin non certifi√© et mode s√©curis√© activ√©');\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n    };\n  }\n\n  /**\n   * V√©rifie qu'un objet impl√©mente bien l'interface EnterprisePlugin\n   */\n  private isValidPlugin(plugin: any): plugin is EnterprisePlugin {\n    return (\n      typeof plugin === 'object' &&\n      plugin.manifest &&\n      typeof plugin.initialize === 'function' &&\n      typeof plugin.destroy === 'function'\n    );\n  }\n\n  /**\n   * Charge les plugins automatiquement\n   */\n  private async loadAutoPlugins(): Promise<void> {\n    for (const pluginName of this.config.autoLoad || []) {\n      if (!this.config.exclude?.includes(pluginName)) {\n        const result = await this.loadPlugin(pluginName);\n        if (!result.success) {\n          this.context?.logger.error(\n            `Erreur lors du chargement automatique du plugin ${pluginName}:`,\n            result.error\n          );\n        }\n      }\n    }\n  }\n\n  /**\n   * Charge les plugins depuis la configuration\n   */\n  private async loadConfigPlugins(config: any): Promise<void> {\n    const plugins = config.plugins || {};\n\n    for (const [pluginName, pluginConfig] of Object.entries(plugins)) {\n      if (!this.config.exclude?.includes(pluginName)) {\n        const result = await this.loadPlugin(pluginName);\n        if (result.success && this.context) {\n          // Appliquer la configuration du plugin\n          if (result.plugin.validateConfig && pluginConfig) {\n            const isValid = result.plugin.validateConfig(pluginConfig);\n            if (isValid !== true) {\n              this.context.logger.warn(\n                `Configuration invalide pour le plugin ${pluginName}: ${isValid}`\n              );\n            }\n          }\n        } else if (!result.success) {\n          this.context?.logger.error(\n            `Erreur lors du chargement du plugin ${pluginName}:`,\n            result.error\n          );\n        }\n      }\n    }\n  }\n\n  /**\n   * Cr√©e un logger pour les plugins\n   */\n  createPluginLogger(pluginName: string): PluginLogger {\n    return {\n      debug: (message: string, ...args: any[]) => {\n        if (this.config.verbose) {\n          console.log(`[${pluginName}] ${message}`, ...args);\n        }\n      },\n      info: (message: string, ...args: any[]) => {\n        console.log(`[${pluginName}] ${message}`, ...args);\n      },\n      warn: (message: string, ...args: any[]) => {\n        console.warn(`[${pluginName}] ${message}`, ...args);\n      },\n      error: (message: string, ...args: any[]) => {\n        console.error(`[${pluginName}] ${message}`, ...args);\n      },\n      success: (message: string, ...args: any[]) => {\n        console.log(`‚úÖ [${pluginName}] ${message}`, ...args);\n      },\n    };\n  }\n\n  /**\n   * D√©truit le gestionnaire de plugins\n   */\n  async destroy(): Promise<void> {\n    const promises = Array.from(this.plugins.values()).map((plugin) =>\n      plugin\n        .destroy()\n        .catch((error) =>\n          this.context?.logger.error(`Erreur lors de la destruction du plugin:`, error)\n        )\n    );\n\n    await Promise.all(promises);\n\n    this.plugins.clear();\n    this.manifests.clear();\n    this.removeAllListeners();\n  }\n}\n"]}